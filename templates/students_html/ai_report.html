<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI课程报告分析系统</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <style>
        /* 基础样式 */
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        
        /* 头部样式 */
        .header {
            background: linear-gradient(135deg, #a89fd2 0%, #c1bbde 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .student-info {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .student-info .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
        
        /* 内容区域样式 */
        .content-container {
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        /* 选项卡样式 */
        .nav-tabs {
            border-bottom: none;
            background-color: #f8f9fa;
        }
        
        .nav-item .nav-link {
            padding: 1rem 2rem;
            border: none;
            color: #6c757d;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 0;
        }
        
        .nav-item .nav-link:hover {
            color: #495057;
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .nav-item .nav-link.active {
            color: #a89fd2;
            background-color: white;
            border-bottom: 3px solid #a89fd2;
        }
        
        /* 表单样式 */
        .form-section {
            padding: 2rem;
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #495057;
        }
        
        .form-control {
            border: 1px solid #e9ecef;
            border-radius: 6px;
            transition: all 0.3s ease;
            padding: 0.75rem;
        }
        
        .form-control:focus {
            border-color: #a89fd2;
            box-shadow: 0 0 0 3px rgba(168, 159, 210, 0.1);
        }
        
        /* 文件上传样式 */
        .file-upload {
            position: relative;
            border: 2px dashed #e1d9e1;
            border-radius: 0;
            padding: 3rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        

        
        .file-upload input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        /* 加载动画 */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(168, 159, 210, 0.2);
            border-left-color: #a89fd2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 主内容区域 -->
    <div class="container">
        <div class="mb-4">
            <a href="javascript:history.back()" class="btn btn-secondary">
                <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回
            </a>
        </div>
        <div class="content-container">
            <!-- 选项卡导航 -->
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload" type="button" role="tab" aria-controls="upload" aria-selected="true">
                        <i class="fa fa-upload" aria-hidden="true"></i> 上传报告
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="compare-tab" data-bs-toggle="tab" data-bs-target="#compare" type="button" role="tab" aria-controls="compare" aria-selected="false">
                        <i class="fa fa-exchange" aria-hidden="true"></i> 报告对比
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="examples-tab" data-bs-toggle="tab" data-bs-target="#examples" type="button" role="tab" aria-controls="examples" aria-selected="false">
                        <i class="fa fa-book" aria-hidden="true"></i> 优秀案例
                    </button>
                </li>
            </ul>
            
            <!-- 选项卡内容 -->
            <div class="tab-content" id="myTabContent">
                <!-- 上传报告选项卡 -->
                <div class="tab-pane fade show active" id="upload" role="tabpanel" aria-labelledby="upload-tab">
                    <div class="form-section">
                        <div class="card">
                            <div class="card-header">
        <h4 class="mb-0">智能报告分析</h4>
    </div>
                            <div class="card-body">
                                <form id="uploadForm">
                                    <div class="mb-4">
                                        <label class="form-label">上传报告文件</label>
                                        <div class="file-upload" id="fileUploadArea">
                                            <input type="file" id="reportFile" accept=".pdf,.doc,.docx,.txt,.md" />
                                            <i class="fa fa-file-text-o text-4xl text-muted mb-2" aria-hidden="true"></i>
                                            <h5>点击或拖拽文件至此上传</h5>
                                            <p class="text-muted">支持格式：PDF, Word, TXT, Markdown</p>
                                            <p id="selectedFileName" class="text-success mt-2"></p>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="reportDesc" class="form-label">报告描述（可选）</label>
                                        <textarea class="form-control" id="reportDesc" rows="3" placeholder="简述报告内容、重点或希望获得的分析角度..."></textarea>
                                    </div>
                                    
                                    <div class="d-grid gap-2">
                                        <button type="submit" class="btn btn-primary w-100 py-3">
                                            <i class="fa fa-magic" aria-hidden="true"></i> 开始智能分析
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- 分析结果区域 -->
                        <div id="analysisResult" class="mt-4">
                            <!-- 分析结果将在这里动态显示 -->
                        </div>
                    </div>
                </div>
                
                <!-- 报告对比选项卡 -->
                <div class="tab-pane fade" id="compare" role="tabpanel" aria-labelledby="compare-tab">
                    <div class="form-section">
                        <div class="card">
                            <div class="card-header">
                <h4 class="mb-0">报告对比分析</h4>
            </div>
                            <div class="card-body">
                                <form id="compareForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-4">
                                            <label class="form-label">上传第一份报告</label>
                                            <div class="file-upload">
                                                <input type="file" id="reportFile1" accept=".pdf,.doc,.docx,.txt,.md" />
                                                <i class="fa fa-file-text-o text-4xl text-muted mb-2" aria-hidden="true"></i>
                                                <h5>报告文件 1</h5>
                                                <p class="text-muted">支持格式：PDF, Word, TXT, Markdown</p>
                                                <p id="selectedFileName1" class="text-success mt-2"></p>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-6 mb-4">
                                            <label class="form-label">上传第二份报告</label>
                                            <div class="file-upload">
                                                <input type="file" id="reportFile2" accept=".pdf,.doc,.docx,.txt,.md" />
                                                <i class="fa fa-file-text-o text-4xl text-muted mb-2" aria-hidden="true"></i>
                                                <h5>报告文件 2</h5>
                                                <p class="text-muted">支持格式：PDF, Word, TXT, Markdown</p>
                                                <p id="selectedFileName2" class="text-success mt-2"></p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid gap-2">
                                        <button type="submit" class="btn btn-primary w-100 py-3">
                                    <i class="fa fa-exchange" aria-hidden="true"></i> 开始对比分析
                                </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- 对比结果区域 -->
                        <div id="compareResult" class="mt-4">
                            <!-- 对比结果将在这里动态显示 -->
                        </div>
                    </div>
                </div>
                
                <!-- 优秀案例选项卡 -->
                <div class="tab-pane fade" id="examples" role="tabpanel" aria-labelledby="examples-tab">
                    <div class="form-section">
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <select class="form-control" id="exampleCategory">
                                    <option value="all">全部类型</option>
                                    <option value="数据分析">数据分析</option>
                                    <option value="前端开发">前端开发</option>
                                    <option value="数据库">数据库</option>
                                    <option value="人工智能">人工智能</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="搜索关键词..." id="exampleSearch">
                                    <button class="btn btn-secondary" id="searchBtn">
                                    <i class="fa fa-search" aria-hidden="true"></i> 搜索
                                </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 优秀案例列表 -->
                        <div id="examplesList" class="row"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    
    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 监听文件选择变化
            setupFileInputs();
            
            // 监听表单提交
            setupFormSubmissions();
            
            // 监听优秀案例选项卡切换
            const examplesTab = document.getElementById('examples-tab');
            examplesTab.addEventListener('shown.bs.tab', loadExamples);
        });
        
        // 设置文件输入监听
        function setupFileInputs() {
            document.getElementById('reportFile').addEventListener('change', function(e) {
                updateFileName(e, 'selectedFileName');
            });
            
            document.getElementById('reportFile1').addEventListener('change', function(e) {
                updateFileName(e, 'selectedFileName1');
            });
            
            document.getElementById('reportFile2').addEventListener('change', function(e) {
                updateFileName(e, 'selectedFileName2');
            });
            
            // 支持拖拽上传
            const fileUploadArea = document.getElementById('fileUploadArea');
            if (fileUploadArea) {
                fileUploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#a89fd2';
                });
                
                fileUploadArea.addEventListener('dragleave', function() {
                    this.style.borderColor = '#e1d9e1';
                });
                
                fileUploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#e1d9e1';
                    
                    if (e.dataTransfer.files.length > 0) {
                        document.getElementById('reportFile').files = e.dataTransfer.files;
                        updateFileName({target: {files: e.dataTransfer.files}}, 'selectedFileName');
                    }
                });
            }
        }
        
        // 更新文件名显示
        function updateFileName(event, elementId) {
            const fileName = event.target.files[0]?.name;
            if (fileName) {
                document.getElementById(elementId).textContent = `已选择: ${fileName}`;
            }
        }
        
        // 设置表单提交事件
        function setupFormSubmissions() {
            // 报告上传表单
            document.getElementById('uploadForm').addEventListener('submit', handleReportUpload);
            
            // 报告对比表单
            document.getElementById('compareForm').addEventListener('submit', handleReportCompare);
            
            // 搜索按钮
            document.getElementById('searchBtn').addEventListener('click', loadExamples);
        }
        
        // 处理报告上传 - 正确处理Content-Type设置
        function handleReportUpload(e) {
            e.preventDefault();
            const fileInput = document.getElementById('reportFile');
            const reportDesc = document.getElementById('reportDesc').value;
            
            // 验证文件是否选择
            if (!fileInput.files || !fileInput.files[0]) {
                showError('请选择要上传的文件');
                return;
            }
            
            // 显示加载状态
            showLoading('analysisResult');
            
            // 第一步：先上传文件获取文件路径
            const fileFormData = new FormData();
            fileFormData.append('file', fileInput.files[0]);
            
            fetch('/api/upload_report_file', {
                method: 'POST',
                // 对于文件上传，让浏览器自动设置Content-Type
                body: fileFormData,
                credentials: 'include'
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`文件上传失败: ${response.status}`);
                }
                return response.json();
            })
            .then(fileData => {
                // 第二步：将文件路径和其他信息作为JSON发送
                const requestData = {
                    file_path: fileData.file_path || `/uploads/${fileInput.files[0].name}`,
                    topic: reportDesc || '',
                    analysis_type: 'standard'
                };
                
                // 使用fetch API发送请求 - 正确设置Content-Type为application/json
                return fetch('/api/evaluation/report', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',  // 关键点：设置Content-Type为application/json
                    },
                    body: JSON.stringify(requestData)  // 将数据转换为JSON字符串
                });
            })
            .then(response => {
                if (!response.ok) {
                    // 处理HTTP错误
                    return response.json().then(errorData => {
                        throw new Error(errorData.error || `请求失败: ${response.status}`);
                    }).catch(() => {
                        throw new Error(`请求失败: ${response.status}`);
                    });
                }
                
                return response.json();
            })
            .then(data => {
                // 显示分析结果
                const resultElement = document.getElementById('analysisResult');
                resultElement.innerHTML = generateMockReport(data);
            })
            .catch(error => {
                // 显示错误信息
                showError(`分析过程中发生错误: ${error.message}`, 'analysisResult');
            });
        }
        
        // 处理报告对比 - 实现两步上传流程
        function handleReportCompare(e) {
            e.preventDefault();
            const fileInput1 = document.getElementById('reportFile1');
            const fileInput2 = document.getElementById('reportFile2');
            
            // 验证文件
            if (!fileInput1.files || !fileInput1.files[0] || !fileInput2.files || !fileInput2.files[0]) {
                showError('请上传两份报告文件进行对比');
                return;
            }
            
            // 显示加载状态
            showLoading('compareResult');
            
            // 上传文件1获取路径
            const uploadFile1 = new FormData();
            uploadFile1.append('file', fileInput1.files[0]);
            
            fetch('/api/upload_report_file', {
                method: 'POST',
                body: uploadFile1,
                credentials: 'include'
            })
            .then(response => {
                if (!response.ok) throw new Error(`文件1上传失败: ${response.status}`);
                return response.json();
            })
            .then(file1Data => {
                const file1Path = file1Data.file_path || `/uploads/${fileInput1.files[0].name}`;
                
                // 上传文件2获取路径
                const uploadFile2 = new FormData();
                uploadFile2.append('file', fileInput2.files[0]);
                
                return fetch('/api/upload_report_file', {
                    method: 'POST',
                    body: uploadFile2,
                    credentials: 'include'
                })
                .then(response => {
                    if (!response.ok) throw new Error(`文件2上传失败: ${response.status}`);
                    return response.json();
                })
                .then(file2Data => {
                    const file2Path = file2Data.file_path || `/uploads/${fileInput2.files[0].name}`;
                    
                    // 构建请求数据
                    const requestData = {
                        file_path_1: file1Path,
                        file_path_2: file2Path,
                        comparison_type: 'standard'
                    };
                    
                    // 发送JSON请求进行对比
                    return fetch('/api/evaluation/compare', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestData),
                        credentials: 'include'
                    });
                });
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(errorData => {
                        throw new Error(errorData.error || `对比请求失败: ${response.status}`);
                    }).catch(() => {
                        throw new Error(`对比请求失败: ${response.status}`);
                    });
                }
                return response.json();
            })
            .then(data => {
                // 显示对比结果
                const resultElement = document.getElementById('compareResult');
                resultElement.innerHTML = generateMockComparison(data);
            })
            .catch(error => {
                // 显示错误信息
                showError(`对比过程中发生错误: ${error.message}`, 'compareResult');
            });
        }
        
        // 加载优秀案例
        function loadExamples() {
            showLoading('examplesList');
            
            const category = document.getElementById('exampleCategory').value;
            const search = document.getElementById('exampleSearch').value;
            
            // 构建查询参数
            let url = '/api/examples';
            if (category !== 'all' || search) {
                url += '?';
                if (category !== 'all') url += 'category=' + encodeURIComponent(category);
                if (category !== 'all' && search) url += '&';
                if (search) url += 'search=' + encodeURIComponent(search);
            }
            
            // 发送GET请求
            fetch(url, {
                method: 'GET',
                headers: {
                    'Accept': 'application/json'
                },
                credentials: 'include'
            })
            .then(handleResponse)
            .then(examples => {
                renderExamples(examples);
            })
            .catch(error => {
                showError('加载案例失败: ' + error.message, 'examplesList');
            });
        }
        
        // 统一处理响应 - 正确实现
        function handleResponse(response) {
            // 检查响应状态
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            // 检查响应是否为JSON格式
            const contentType = response.headers.get('content-type');
            if (contentType && contentType.includes('application/json')) {
                return response.json();
            } else {
                // 如果不是JSON，返回空数组让renderExamples使用模拟数据
                console.warn('Response is not JSON, using mock data');
                return Promise.resolve([]);
            }
        }
        
        // 显示加载状态
        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p class="ml-3">正在处理，请稍候...</p>
                </div>
            `;
        }
        
        // 显示错误信息
        function showError(message, elementId) {
            if (elementId) {
                const element = document.getElementById(elementId);
                element.innerHTML = `<div class="alert alert-danger">${message}</div>`;
            } else {
                alert(message);
            }
        }
        
        // 生成模拟报告结果
        function generateMockReport(data) {
            // 使用API返回的真实数据
            const apiData = data.report_data || {};
            
            // 构建建议结构
            const suggestions = apiData.suggestions || [];
            
            // 如果API返回的建议格式不符合要求，使用转换后的格式
            let formattedSuggestions = [];
            if (suggestions.length > 0 && typeof suggestions[0] === 'string') {
                // 如果是简单的字符串数组，转换为前端期望的格式
                formattedSuggestions = [
                    {
                        dimension: '内容改进',
                        problems: ['报告内容可进一步提升'],
                        recommendations: suggestions
                    }
                ];
            } else {
                // 如果已经是期望的格式，直接使用
                formattedSuggestions = suggestions;
            }
            
            const realData = {
                filename: document.getElementById('reportFile').files[0]?.name || '未知文件',
                overall_score: apiData.score || 0,
                overall_grade: apiData.grade || '未评级',
                evaluation: {
                    '综合评价': { 
                        score: apiData.score || 0, 
                        comment: apiData.analysis || '报告分析内容缺失'
                    }
                },
                suggestions: formattedSuggestions,
                reference_examples: [
                    { id: 1, title: '优秀学术报告示例', score: 95 },
                    { id: 2, title: '内容深度分析参考', score: 92 }
                ]
            };
            
            // 生成HTML报告
            return `
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <h4>报告分析结果: ${realData.filename}</h4>
                            <div class="score-display">${realData.overall_score}</div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- 各维度评价 -->
                        <h5 class="mb-3">各维度评价</h5>
                        <div class="row mb-4">
                            ${Object.entries(realData.evaluation).map(([dim, info]) => `
                                <div class="col-md-6 mb-3">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <h6>${dim}</h6>
                                                <span class="badge bg-primary">${info.score}分</span>
                                            </div>
                                            <div class="progress mt-2 mb-2">
                                                <div class="progress-bar bg-primary" style="width: ${info.score}%;" role="progressbar" aria-valuenow="${info.score}" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <p class="text-sm text-muted">${info.comment}</p>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- 提升建议 -->
                        <h5 class="mb-3">提升建议</h5>
                        ${realData.suggestions.map(suggestion => `
                            <div class="card mb-3">
                                <div class="card-header">${suggestion.dimension}改进建议</div>
                                <div class="card-body">
                                    <div class="mb-2">
                                        <h6>存在问题：</h6>
                                        <ul class="list-disc pl-5">
                                            ${suggestion.problems.map(prob => `<li>${prob}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div>
                                        <h6>改进方向：</h6>
                                        <ul class="list-disc pl-5">
                                            ${suggestion.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                        
                        <!-- 参考案例 -->
                        <h5 class="mb-3">参考案例</h5>
                        <div class="row">
                            ${realData.reference_examples.map(ex => `
                                <div class="col-md-4 mb-3">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6>${ex.title}</h6>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span class="text-success">${ex.score}分</span>
                                                <a href="#" class="btn btn-sm btn-secondary">查看详情</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        
        // 生成模拟对比结果
        function generateMockComparison(data) {
            // 生成模拟数据
            const file1 = document.getElementById('reportFile1').files[0]?.name || '报告1';
            const file2 = document.getElementById('reportFile2').files[0]?.name || '报告2';
            
            const mockData = {
                report1: { filename: file1, overall_score: 85 + Math.floor(Math.random() * 5) },
                report2: { filename: file2, overall_score: 88 + Math.floor(Math.random() * 5) },
                dimension_comparison: [
                    { dimension: '内容深度', report1_score: 85, report2_score: 90, stronger: 'report2' },
                    { dimension: '结构完整性', report1_score: 88, report2_score: 87, stronger: 'report1' },
                    { dimension: '创新性', report1_score: 82, report2_score: 89, stronger: 'report2' },
                    { dimension: '专业性', report1_score: 86, report2_score: 88, stronger: 'report2' },
                    { dimension: '语言表达', report1_score: 90, report2_score: 89, stronger: 'report1' }
                ],
                overall_result: '两份报告都达到了良好水平，第二份报告在创新性和内容深度方面表现更好，第一份报告在结构完整性和语言表达方面略有优势。'
            };
            
            return `
                <div class="card">
                    <div class="card-header">
                        <h3>报告对比分析结果</h3>
                    </div>
                    <div class="card-body">
                        <!-- 整体对比概览 -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="card bg-light">
                                    <div class="card-body text-center">
                                        <h5>报告1</h5>
                                        <p class="text-muted">${mockData.report1.filename}</p>
                                        <div class="score-display" style="color: #4f46e5; font-size: 2rem; font-weight: bold;">${mockData.report1.overall_score}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card bg-light">
                                    <div class="card-body text-center">
                                        <h5>报告2</h5>
                                        <p class="text-muted">${mockData.report2.filename}</p>
                                        <div class="score-display" style="color: #4f46e5; font-size: 2rem; font-weight: bold;">${mockData.report2.overall_score}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 整体评价 -->
                        <div class="alert alert-info">
                            <h5 class="alert-heading">整体评价</h5>
                            <p>${mockData.overall_result}</p>
                        </div>
                        
                        <!-- 维度详细对比 -->
                        <h5 class="mb-3">各维度详细对比</h5>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>评价维度</th>
                                    <th>报告1得分</th>
                                    <th>报告2得分</th>
                                    <th>更优报告</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${mockData.dimension_comparison.map(dim => `
                                    <tr>
                                        <td>${dim.dimension}</td>
                                        <td>${dim.report1_score}</td>
                                        <td>${dim.report2_score}</td>
                                        <td>
                                            <span class="badge bg-primary">
                                                ${dim.stronger === 'report1' ? '报告1' : '报告2'}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }
        
        // 渲染优秀案例
        function renderExamples(examples) {
            // 如果没有数据，使用模拟数据
            if (!examples || !Array.isArray(examples) || examples.length === 0) {
                examples = [
                    { id: 1, title: '数据挖掘技术在教育分析中的应用', category: '人工智能', description: '探索如何利用数据挖掘技术分析学生学习行为，提升教学效果。', tags: ['数据挖掘', '机器学习', '教育分析'], score: 95 },
                    { id: 2, title: '响应式网页设计最佳实践', category: '前端开发', description: '详细介绍响应式设计的核心原则和实现方法，打造跨设备完美体验。', tags: ['响应式设计', 'CSS3', '用户体验'], score: 92 },
                    { id: 3, title: '企业级数据库性能优化策略', category: '数据库', description: '深入探讨大型企业数据库的性能瓶颈及优化方案，提升系统响应速度。', tags: ['数据库', '性能优化', 'SQL'], score: 93 },
                    { id: 4, title: '基于深度学习的图像识别系统', category: '人工智能', description: '使用最新深度学习技术构建高精度图像识别系统，应用于安防领域。', tags: ['深度学习', '计算机视觉', '图像识别'], score: 94 }
                ];
            }
            
            const examplesList = document.getElementById('examplesList');
            examplesList.innerHTML = '';
            
            examples.forEach(example => {
                const card = document.createElement('div');
                card.className = 'col-md-6 mb-4';
                card.innerHTML = `
                    <div class="card h-100">
                        <div class="card-header">
                            <div class="d-flex justify-content-between">
                                <h5 class="card-title mb-0">${example.title}</h5>
                                <span class="badge bg-primary">${example.category}</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <p class="card-text">${example.description}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    ${Array.isArray(example.tags) ? example.tags.map(tag => `<span class="badge bg-secondary me-1">${tag}</span>`).join('') : ''}
                                </div>
                                <span class="text-success font-weight-bold">${example.score}分</span>
                            </div>
                        </div>
                        <div class="card-footer">
                            <a href="#" class="btn btn-secondary btn-sm">
                                <i class="fa fa-download" aria-hidden="true"></i> 下载案例
                            </a>
                        </div>
                    </div>
                `;
                examplesList.appendChild(card);
            });
        }
    </script>
</body>
</html>